<!DOCTYPE html>
<html>
<head>
  <style>
    :root {
      /* Light mode colors (default) - using Figma panel colors */
      --bg-primary: #F7F7F7;
      --bg-input: #ffffff;
      --bg-secondary: #f0f0f0;
      --bg-secondary-hover: #e5e5e5;
      --text-primary: #000000;
      --text-secondary: #333333;
      --text-tertiary: #666666;
      --input-border: #E1E1E1;
      --input-border-hover: #C9C9C9;
      --border-focus: #18a0fb;
      --button-primary: #18a0fb;
      --button-primary-hover: #1592e6;
      --button-primary-text: #ffffff;
      --button-secondary: #f0f0f0;
      --button-secondary-hover: #e5e5e5;
      --button-secondary-text: #333333;
      --error-color: #f24822;
      --bg-direction-toggle: #f0f0f0;
      --direction-toggle-shadow: #e5e5e5;
    }

    @media (prefers-color-scheme: dark) {
      :root {
        /* Dark mode colors - using Figma panel colors */
        --bg-primary: #2C2C2C;
        --bg-input: #383838;
        --bg-secondary: #3d3d3d;
        --bg-secondary-hover: #4a4a4a;
        --text-primary: #ffffff;
        --text-secondary: #E5E5E5;
        --text-tertiary: #B3B3B3;
        --input-border: #4A4A4A;
        --input-border-hover: #5A5A5A;
        --border-focus: #18a0fb;
        --button-primary: #18a0fb;
        --button-primary-hover: #1592e6;
        --button-primary-text: #ffffff;
        --button-secondary: #3d3d3d;
        --button-secondary-hover: #4a4a4a;
        --button-secondary-text: #e5e5e5;
        --error-color: #ff6b6b;
        --bg-direction-toggle: #2c2c2c;
        --direction-toggle-shadow: #444444;
      }
    }

    body {
      font-family: 'Inter', sans-serif;
      padding: 16px;
      margin: 0;
      background: var(--bg-primary);
      color: var(--text-primary);
    }
    
    .container {
      display: flex;
      flex-direction: column;
      gap: 24px;
      padding-bottom: 80px; /* Space for fixed button group */
    }
    
    .title {
      font-size: 14px;
      font-weight: 600;
      color: var(--text-primary);
      margin: 0 0 8px 0;
    }
    
    .section {
      display: flex;
      flex-direction: column;
      gap: 8px;
    }
    
    #alignment-label {
      margin-bottom: 0;
    }
    
    .label {
      font-size: 11px;
      font-weight: 500;
      color: var(--text-secondary);
      margin-bottom: 4px;
    }
    
    .input-group {
      display: flex;
      gap: 8px;
      align-items: center;
    }
    
    .input-row {
      display: grid;
      grid-template-columns: 1fr 1fr;
      gap: 8px;
    }
    
    .input-with-label {
      display: flex;
      align-items: center;
      gap: 6px;
      min-width: 0;
    }
    
    .input-label {
      font-size: 11px;
      font-weight: 500;
      color: var(--text-secondary);
      min-width: 12px;
      flex-shrink: 0;
    }
    
    input[type="number"],
    input[type="text"] {
      padding: 4px 6px;
      border: none;
      border-radius: 4px;
      font-size: 11px;
      font-family: 'Inter', sans-serif;
      background: var(--bg-input);
      color: var(--text-primary);
      box-sizing: border-box;
      height: 24px;
      min-width: 0;
      width: 100%;
    }
    
    .input-with-label input[type="number"] {
      flex: 1;
      min-width: 0;
      width: 100%;
    }
    
    .section > input[type="number"] {
      width: 80px;
    }
    
    .padding-inputs-row {
      display: flex;
      gap: 8px;
      align-items: center;
    }
    
    .padding-input-wrapper {
      display: flex;
      align-items: center;
      flex: 1;
      min-width: 0;
      overflow: hidden;
      background: var(--bg-input);
      border-radius: 4px;
    }
    
    .input-icon-img {
      width: 24px;
      height: 24px;
      flex-shrink: 0;
      opacity: 0.7;
      color: var(--text-secondary);
    }
    
    .direction-toggles {
      display: flex;
      margin-top: 4px;
      padding: 1px;
      background: var(--bg-input);
      border-radius: 4px;
    }
    
    .direction-toggle {
      width: 28px;
      height: 28px;
      padding: 2px;
      border: none;
      border-radius: 4px;
      background: transparent;
      cursor: pointer;
      display: flex;
      align-items: center;
      justify-content: center;
      transition: background-color 0.15s ease;
    }
    
    .direction-toggle.active {
      background: var(--bg-direction-toggle, #2c2c2c);
      box-shadow: inset 0 0 0 .0625rem var(--direction-toggle-shadow, #444444);
    }
    
    .direction-toggle svg {
      width: 24px;
      height: 24px;
      opacity: 0.7;
      color: var(--text-secondary);
    }

    .direction-toggle:hover {
      background: var(--bg-secondary-hover);
    }
    
    .direction-toggle.active svg {
      opacity: 1;
    }
    
    .padding-input {
      flex: 1;
      min-width: 0;
      width: 0;
    }
    
    input[type="number"]:focus,
    input[type="text"]:focus {
      outline: none;
    }
    
    input[type="number"]::placeholder,
    input[type="text"]::placeholder {
      color: var(--text-tertiary);
    }
    
    .frame-spacing-wrapper {
      display: flex;
      align-items: center;
      background: var(--bg-input);
      border-radius: 4px;
      width: 130px;
    }
    

    
    .checkbox-group {
      display: flex;
      align-items: center;
      gap: 6px;
      margin-top: 4px;
    }
    
    input[type="checkbox"] {
      width: 14px;
      height: 14px;
      cursor: pointer;
      accent-color: var(--button-primary);
    }
    
    .checkbox-label {
      font-size: 11px;
      color: var(--text-tertiary);
      cursor: pointer;
    }
    
    .alignment-groups {
      display: flex;
      gap: 8px;
      margin-top: 8px;
    }
    
    .alignment-group {
      display: flex;
      padding: 1px;
      background: var(--bg-input);
      border-radius: 4px;
      gap: 0;
      width: 100%;
    }
    
    .alignment-button {
      width: 28px;
      height: 28px;
      padding: 2px;
      border: none;
      border-radius: 3px;
      background: transparent;
      cursor: pointer;
      display: flex;
      align-items: center;
      justify-content: center;
      transition: background-color 0.15s ease;
    }
    
    .alignment-button:hover {
      background: var(--bg-secondary-hover);
    }
    
    .alignment-button.active {
      background: var(--bg-direction-toggle);
      box-shadow: inset 0 0 0 .0625rem var(--direction-toggle-shadow);    }
    
    .alignment-button svg {
      width: 20px;
      height: 20px;
    }
    
    .alignment-button svg path {
      fill: var(--text-secondary);
      transition: fill 0.15s ease;
    }
    
    .alignment-button.active svg path {
      fill: var(--text-primary);
    }
    
    .button-group {
      display: flex;
      gap: 8px;
      position: fixed;
      left: 0;
      right: 0;
      bottom: 0;
      background: var(--bg-primary);
      padding: 16px;
      z-index: 50;
    }
    
    button {
      flex: 1;
      padding: 8px 16px;
      border: none;
      border-radius: 4px;
      font-size: 11px;
      font-weight: 500;
      font-family: 'Inter', sans-serif;
      cursor: pointer;
      transition: background-color 0.2s;
    }
    
    button:active {
      transform: scale(0.98);
    }
    
    .button-primary {
      background: var(--button-primary);
      color: var(--button-primary-text);
    }
    
    .button-primary:hover {
      background: var(--button-primary-hover);
    }
    
    .button-secondary {
      background: var(--button-secondary);
      color: var(--button-secondary-text);
    }
    
    .button-secondary:hover {
      background: var(--button-secondary-hover);
    }
    
    .error {
      color: var(--error-color);
      font-size: 11px;
      margin-top: 4px;
      display: none;
    }
    
    .error.show {
      display: block;
    }
    
    .helper-text {
      font-size: 10px;
      color: var(--text-tertiary);
      margin-top: 4px;
      line-height: 1.4;
    }
    
    .preset-section {
      display: flex;
      flex-direction: column;
      gap: 8px;
    }
    
    .preset-dropdown-container {
      position: relative;
      display: flex;
      gap: 2px;
      align-items: center;
    }
    
    .preset-dropdown-trigger {
      flex: 1;
      display: flex;
      align-items: center;
      gap: 4px;
      padding: 4px 8px;
      border: none;
      border-radius: 4px;
      font-size: 11px;
      font-family: 'Inter', sans-serif;
      background: var(--bg-input);
      color: var(--text-primary);
      height: 24px;
      cursor: pointer;
      text-align: left;
    }
    
    .preset-dropdown-trigger:hover {
      background: var(--bg-secondary-hover);
    }
    
    .preset-dropdown-label {
      color: var(--text-secondary);
      flex-shrink: 0;
    }
    
    .preset-dropdown-trigger-text {
      flex: 1;
      overflow: hidden;
      text-overflow: ellipsis;
      white-space: nowrap;
    }
    
    .preset-dropdown-caret {
      width: 16px;
      height: 16px;
      color: var(--text-tertiary);
      flex-shrink: 0;
      transition: transform 0.15s ease;
    }
    
    .preset-dropdown-container.open .preset-dropdown-caret {
      transform: rotate(180deg);
    }
    
    .preset-add-btn {
      display: flex;
      flex: 0;
      align-items: center;
      justify-content: center;
      padding: 0;
      border: none;
      border-radius: 2px;
      background: transparent;
      color: var(--text-tertiary);
      cursor: pointer;
      flex-shrink: 0;
      margin-left: 8px;
    }
    
    .preset-add-btn:hover {
      color: var(--button-primary);
    }
    
    .preset-add-btn svg {
      width: 16px;
      height: 16px;
    }
    
    .preset-dropdown-menu {
      display: none;
      position: absolute;
      top: calc(100% + 4px);
      left: 0;
      width: calc(100% - 24px);
      background: var(--bg-input);
      border-radius: 4px;
      box-shadow: 0 2px 8px rgba(0, 0, 0, 0.15);
      z-index: 100;
      max-height: 200px;
      overflow-y: auto;
    }
    
    .preset-dropdown-container.open .preset-dropdown-menu {
      display: block;
    }
    
    .preset-dropdown-item {
      display: flex;
      align-items: center;
      gap: 4px;
      padding: 6px 8px;
      font-size: 11px;
      font-family: 'Inter', sans-serif;
      color: var(--text-primary);
      cursor: pointer;
    }
    
    .preset-dropdown-item:hover {
      background: var(--bg-secondary-hover);
    }
    
    .preset-dropdown-item.selected {
      background: var(--bg-secondary);
    }
    
    .preset-dropdown-item-text {
      flex: 1;
      overflow: hidden;
      text-overflow: ellipsis;
      white-space: nowrap;
    }
    
    .preset-dropdown-item-delete {
      visibility: hidden;
      display: flex;
      flex: 0;
      align-items: center;
      justify-content: center;
      width: 16px;
      height: 16px;
      padding: 0;
      border: none;
      border-radius: 2px;
      background: transparent;
      color: var(--text-tertiary);
      cursor: pointer;
      flex-shrink: 0;
    }
    
    .preset-dropdown-item:hover .preset-dropdown-item-delete {
      visibility: visible;
    }
    
    .preset-dropdown-item-delete:hover {
      color: var(--error-color);
    }
    
    .preset-dropdown-item-delete svg {
      width: 12px;
      height: 12px;
    }
    
    .preset-dropdown-divider {
      height: 1px;
      background: var(--input-border);
      margin: 4px 0;
    }
    
    .preset-dropdown-action {
      display: flex;
      align-items: center;
      padding: 6px 8px;
      font-size: 11px;
      font-family: 'Inter', sans-serif;
      color: var(--text-secondary);
      cursor: pointer;
      gap: 6px;
    }
    
    .preset-dropdown-action:hover {
      background: var(--bg-secondary-hover);
      color: var(--text-primary);
    }
    
    .preset-dropdown-action svg {
      width: 12px;
      height: 12px;
    }
    
    .preset-modal {
      display: none;
      position: fixed;
      top: 0;
      left: 0;
      right: 0;
      bottom: 0;
      background: rgba(0, 0, 0, 0.5);
      z-index: 100;
      align-items: center;
      justify-content: center;
    }
    
    .preset-modal.show {
      display: flex;
    }
    
    .preset-modal-content {
      background: var(--bg-primary);
      padding: 16px;
      border-radius: 8px;
      width: 240px;
      display: flex;
      flex-direction: column;
      gap: 12px;
    }
    
    .preset-modal-title {
      font-size: 12px;
      font-weight: 600;
      color: var(--text-primary);
      margin: 0;
    }
    
    .preset-modal-input {
      padding: 6px 8px;
      border: 1px solid var(--input-border);
      border-radius: 4px;
      font-size: 11px;
      font-family: 'Inter', sans-serif;
      background: var(--bg-input);
      color: var(--text-primary);
    }
    
    .preset-modal-input:focus {
      outline: none;
      border-color: var(--border-focus);
    }
    
    .preset-modal-buttons {
      display: flex;
      gap: 8px;
      justify-content: flex-end;
    }
    
  </style>
</head>
<body>
  <div class="container">
    <h2 class="title" id="title">Create Section</h2>
    
    <div class="preset-section">
      <div class="preset-dropdown-container" id="preset-dropdown-container">
        <button type="button" class="preset-dropdown-trigger" id="preset-dropdown-trigger">
          <span class="preset-dropdown-label">Preset:</span>
          <span class="preset-dropdown-trigger-text" id="preset-dropdown-text">Default</span>
          <svg class="preset-dropdown-caret" viewBox="0 0 24 24" fill="none" xmlns="http://www.w3.org/2000/svg">
            <path d="M7 10L12 15L17 10H7Z" fill="currentColor"/>
          </svg>
        </button>
        <button type="button" class="preset-add-btn" id="preset-add-btn" title="Save current as preset">
          <svg viewBox="0 0 24 24" fill="none" xmlns="http://www.w3.org/2000/svg">
            <path d="M12 5V19M5 12H19" stroke="currentColor" stroke-width="2" stroke-linecap="round"/>
          </svg>
        </button>
        <div class="preset-dropdown-menu" id="preset-dropdown-menu">
          <!-- Items will be populated by JavaScript -->
        </div>
      </div>
    </div>
    
    <div class="section">
      <div class="label">Layout Direction</div>
      <div class="direction-toggles">
        <button type="button" class="direction-toggle active" id="layout-horizontal" data-layout="horizontal" aria-label="Horizontal" title="Horizontal layout">
          <svg width="24" height="24" viewBox="0 0 24 24" fill="none" xmlns="http://www.w3.org/2000/svg">
            <path d="M15.147 13.147C15.2408 13.0533 15.368 13.0006 15.5005 13.0006C15.6331 13.0006 15.7603 13.0533 15.854 13.147L17.854 15.147C17.9478 15.2408 18.0004 15.3679 18.0004 15.5005C18.0004 15.6331 17.9478 15.7602 17.854 15.854L15.854 17.854C15.7597 17.9451 15.6334 17.9955 15.5023 17.9943C15.3712 17.9932 15.2458 17.9406 15.1531 17.8479C15.0604 17.7552 15.0078 17.6298 15.0067 17.4987C15.0056 17.3676 15.056 17.2413 15.147 17.147L16.293 16H6.50004L6.39904 15.99C6.28601 15.967 6.18439 15.9057 6.1114 15.8164C6.03841 15.7271 5.99854 15.6153 5.99854 15.5C5.99854 15.3847 6.03841 15.2729 6.1114 15.1836C6.18439 15.0943 6.28601 15.033 6.39904 15.01L6.50004 15H16.293L15.147 13.854C15.0533 13.7602 15.0006 13.6331 15.0006 13.5005C15.0006 13.3679 15.0533 13.2408 15.147 13.147ZM9.65404 6.007C10.0234 6.04512 10.3655 6.21889 10.6141 6.49468C10.8628 6.77047 11.0003 7.12868 11 7.5V9.5L10.993 9.653C10.958 9.99645 10.8056 10.3173 10.5614 10.5614C10.3173 10.8055 9.99648 10.958 9.65304 10.993L9.50004 11H7.50004L7.34704 10.992C7.00392 10.9568 6.68343 10.8044 6.43954 10.5605C6.19564 10.3166 6.04325 9.99611 6.00804 9.653L6.00004 9.5V7.5C6.00008 7.12869 6.13784 6.7706 6.38665 6.495C6.63547 6.2194 6.97767 6.04587 7.34704 6.008L7.50004 6H9.50004L9.65404 6.007ZM16.654 6.007C17.0234 6.04512 17.3655 6.21889 17.6141 6.49468C17.8628 6.77047 18.0003 7.12868 18 7.5V9.5L17.993 9.653C17.958 9.99645 17.8056 10.3173 17.5614 10.5614C17.3173 10.8055 16.9965 10.958 16.653 10.993L16.5 11H14.5L14.347 10.992C14.0039 10.9568 13.6834 10.8044 13.4395 10.5605C13.1956 10.3166 13.0433 9.99611 13.008 9.653L13 9.5V7.5C13.0001 7.12869 13.1378 6.7706 13.3867 6.495C13.6355 6.2194 13.9777 6.04587 14.347 6.008L14.5 6H16.5L16.654 6.007ZM14.5 7C14.3674 7 14.2403 7.05268 14.1465 7.14645C14.0527 7.24021 14 7.36739 14 7.5V9.5C14 9.63261 14.0527 9.75979 14.1465 9.85355C14.2403 9.94732 14.3674 10 14.5 10H16.5C16.6326 10 16.7598 9.94732 16.8536 9.85355C16.9474 9.75979 17 9.63261 17 9.5V7.5C17 7.36739 16.9474 7.24021 16.8536 7.14645C16.7598 7.05268 16.6326 7 16.5 7H14.5ZM7.50004 7C7.36743 7 7.24025 7.05268 7.14648 7.14645C7.05271 7.24021 7.00004 7.36739 7.00004 7.5V9.5C7.00004 9.63261 7.05271 9.75979 7.14648 9.85355C7.24025 9.94732 7.36743 10 7.50004 10H9.50004C9.63264 10 9.75982 9.94732 9.85359 9.85355C9.94736 9.75979 10 9.63261 10 9.5V7.5C10 7.36739 9.94736 7.24021 9.85359 7.14645C9.75982 7.05268 9.63264 7 9.50004 7H7.50004Z" fill="currentColor"/>
          </svg>
        </button>
        <button type="button" class="direction-toggle" id="layout-vertical" data-layout="vertical" aria-label="Vertical" title="Vertical layout">
          <svg width="24" height="24" viewBox="0 0 24 24" fill="none" xmlns="http://www.w3.org/2000/svg">
            <path d="M9.654 13.008C10.0232 13.0461 10.3651 13.2197 10.6138 13.4953C10.8624 13.7709 11 14.1289 11 14.5V16.5L10.992 16.653C10.957 16.9961 10.8049 17.3167 10.5612 17.5608C10.3175 17.8049 9.99709 17.9575 9.654 17.993L9.5 18H7.5L7.347 17.992C7.00389 17.9568 6.68339 17.8044 6.4395 17.5605C6.19561 17.3166 6.04322 16.9961 6.008 16.653L6 16.5V14.5C6.00004 14.1287 6.1378 13.7706 6.38662 13.495C6.63544 13.2194 6.97763 13.0459 7.347 13.008L7.5 13H9.5L9.654 13.008ZM15.5 6C15.6153 5.99998 15.727 6.03978 15.8163 6.11267C15.9056 6.18556 15.9669 6.28706 15.99 6.4L16 6.5V16.294L17.146 15.148C17.2413 15.0623 17.3659 15.0163 17.4941 15.0197C17.6223 15.023 17.7443 15.0754 17.835 15.166C17.9257 15.2566 17.9783 15.3786 17.9818 15.5067C17.9853 15.6349 17.9396 15.7595 17.854 15.855L15.854 17.855C15.7602 17.9487 15.6331 18.0014 15.5005 18.0014C15.3679 18.0014 15.2408 17.9487 15.147 17.855L13.147 15.855C13.0559 15.7607 13.0055 15.6344 13.0067 15.5033C13.0078 15.3722 13.0604 15.2468 13.1531 15.1541C13.2458 15.0614 13.3712 15.0088 13.5023 15.0077C13.6334 15.0065 13.7597 15.0569 13.854 15.148L15 16.294V6.5L15.01 6.4C15.0331 6.28706 15.0944 6.18556 15.1837 6.11267C15.273 6.03978 15.3847 5.99998 15.5 6ZM7.5 14C7.36739 14 7.24021 14.0527 7.14645 14.1464C7.05268 14.2402 7 14.3674 7 14.5V16.5C7 16.6326 7.05268 16.7598 7.14645 16.8536C7.24021 16.9473 7.36739 17 7.5 17H9.5C9.63261 17 9.75979 16.9473 9.85355 16.8536C9.94732 16.7598 10 16.6326 10 16.5V14.5C10 14.3674 9.94732 14.2402 9.85355 14.1464C9.75979 14.0527 9.63261 14 9.5 14H7.5ZM9.654 6.008C10.0232 6.0461 10.3651 6.21973 10.6138 6.49531C10.8624 6.77089 11 7.12885 11 7.5V9.5L10.992 9.653C10.957 9.99614 10.8049 10.3167 10.5612 10.5608C10.3175 10.8049 9.99709 10.9575 9.654 10.993L9.5 11H7.5L7.347 10.992C7.00389 10.9568 6.68339 10.8044 6.4395 10.5605C6.19561 10.3166 6.04322 9.99611 6.008 9.653L6 9.5V7.5C6.00004 7.12869 6.1378 6.7706 6.38662 6.495C6.63544 6.2194 6.97763 6.04587 7.347 6.008L7.5 6H9.5L9.654 6.008ZM7.5 7C7.36739 7 7.24021 7.05268 7.14645 7.14645C7.05268 7.24021 7 7.36739 7 7.5V9.5C7 9.63261 7.05268 9.75979 7.14645 9.85355C7.24021 9.94732 7.36739 10 7.5 10H9.5C9.63261 10 9.75979 9.94732 9.85355 9.85355C9.94732 9.75979 10 9.63261 10 9.5V7.5C10 7.36739 9.94732 7.24021 9.85355 7.14645C9.75979 7.05268 9.63261 7 9.5 7H7.5Z" fill="currentColor"/>
          </svg>
        </button>
        <button type="button" class="direction-toggle" id="layout-maintain" data-layout="maintain" aria-label="Maintain Positions" title="Maintain positions">
          <svg width="24" height="24" viewBox="0 0 24 24" fill="none" xmlns="http://www.w3.org/2000/svg">
            <path d="M11.653 13.008C12.0224 13.0459 12.3646 13.2194 12.6134 13.495C12.8622 13.7706 13 14.1287 13 14.5V16.5L12.992 16.653C12.957 16.9963 12.8047 17.317 12.5608 17.5611C12.3169 17.8052 11.9963 17.9577 11.653 17.993L11.5 18H9.5L9.347 17.992C9.00371 17.957 8.68298 17.8047 8.43889 17.5608C8.19479 17.3169 8.04226 16.9963 8.007 16.653L8 16.5V14.5C8.00004 14.1287 8.1378 13.7706 8.38662 13.495C8.63544 13.2194 8.97763 13.0459 9.347 13.008L9.5 13H11.5L11.653 13.008ZM9.5 14C9.36739 14 9.24021 14.0527 9.14645 14.1464C9.05268 14.2402 9 14.3674 9 14.5V16.5C9 16.6326 9.05268 16.7598 9.14645 16.8536C9.24021 16.9473 9.36739 17 9.5 17H11.5C11.6326 17 11.7598 16.9473 11.8536 16.8536C11.9473 16.7598 12 16.6326 12 16.5V14.5C12 14.3674 11.9473 14.2402 11.8536 14.1464C11.7598 14.0527 11.6326 14 11.5 14H9.5ZM16.653 8.008C17.0224 8.04587 17.3646 8.2194 17.6134 8.495C17.8622 8.7706 18 9.12869 18 9.5V11.5L17.992 11.653C17.957 11.9963 17.8047 12.317 17.5608 12.5611C17.3169 12.8052 16.9963 12.9577 16.653 12.993L16.5 13H14.5L14.347 12.992C14.0037 12.957 13.683 12.8047 13.4389 12.5608C13.1948 12.3169 13.0423 11.9963 13.007 11.653L13 11.5V9.5C13 9.12869 13.1378 8.7706 13.3866 8.495C13.6354 8.2194 13.9776 8.04587 14.347 8.008L14.5 8H16.5L16.653 8.008ZM14.5 9C14.3674 9 14.2402 9.05268 14.1464 9.14645C14.0527 9.24021 14 9.36739 14 9.5V11.5C14 11.6326 14.0527 11.7598 14.1464 11.8536C14.2402 11.9473 14.3674 12 14.5 12H16.5C16.6326 12 16.7598 11.9473 16.8536 11.8536C16.9473 11.7598 17 11.6326 17 11.5V9.5C17 9.36739 16.9473 9.24021 16.8536 9.14645C16.7598 9.05268 16.6326 9 16.5 9H14.5ZM9.653 6.008C10.0224 6.04587 10.3646 6.2194 10.6134 6.495C10.8622 6.7706 11 7.12869 11 7.5V9.5L10.992 9.653C10.957 9.99629 10.8047 10.317 10.5608 10.5611C10.3169 10.8052 9.99627 10.9577 9.653 10.993L9.5 11H7.5L7.347 10.992C7.00371 10.957 6.68298 10.8047 6.43889 10.5608C6.19479 10.3169 6.04226 9.99627 6.007 9.653L6 9.5V7.5C6.00004 7.12869 6.1378 6.7706 6.38662 6.495C6.63544 6.2194 6.97763 6.04587 7.347 6.008L7.5 6H9.5L9.653 6.008ZM7.5 7C7.36739 7 7.24021 7.05268 7.14645 7.14645C7.05268 7.24021 7 7.36739 7 7.5V9.5C7 9.63261 7.05268 9.75979 7.14645 9.85355C7.24021 9.94732 7.36739 10 7.5 10H9.5C9.63261 10 9.75979 9.94732 9.85355 9.85355C9.94732 9.75979 10 9.63261 10 9.5V7.5C10 7.36739 9.94732 7.24021 9.85355 7.14645C9.75979 7.05268 9.63261 7 9.5 7H7.5Z" fill="currentColor"/>
          </svg>
        </button>
      </div>
    </div>
    
    <div class="section">
      <div class="label">Section Padding</div>
      <div class="padding-inputs-row">
        <div class="padding-input-wrapper">
          <svg width="24" height="24" viewBox="0 0 24 24" fill="none" xmlns="http://www.w3.org/2000/svg" class="input-icon-img">
            <path fill-rule="evenodd" clip-rule="evenodd" d="M8 7.5C8 7.36739 7.94732 7.24021 7.85355 7.14645C7.75979 7.05268 7.63261 7 7.5 7C7.36739 7 7.24021 7.05268 7.14645 7.14645C7.05268 7.24021 7 7.36739 7 7.5V16.5C7 16.6326 7.05268 16.7598 7.14645 16.8536C7.24021 16.9473 7.36739 17 7.5 17C7.63261 17 7.75979 16.9473 7.85355 16.8536C7.94732 16.7598 8 16.6326 8 16.5V7.5ZM16.5 7C16.6326 7 16.7598 7.05268 16.8536 7.14645C16.9473 7.24021 17 7.36739 17 7.5V16.5C17 16.6326 16.9473 16.7598 16.8536 16.8536C16.7598 16.9473 16.6326 17 16.5 17C16.3674 17 16.2402 16.9473 16.1464 16.8536C16.0527 16.7598 16 16.6326 16 16.5V7.5C16 7.36739 16.0527 7.24021 16.1464 7.14645C16.2402 7.05268 16.3674 7 16.5 7ZM13 13V11H11V13H13ZM14 11C14 10.7348 13.8946 10.4804 13.7071 10.2929C13.5196 10.1054 13.2652 10 13 10H11C10.7348 10 10.4804 10.1054 10.2929 10.2929C10.1054 10.4804 10 10.7348 10 11V13C10 13.2652 10.1054 13.5196 10.2929 13.7071C10.4804 13.8946 10.7348 14 11 14H13C13.2652 14 13.5196 13.8946 13.7071 13.7071C13.8946 13.5196 14 13.2652 14 13V11Z" fill="currentColor"/>
          </svg>
          <input type="text" id="padding-horizontal" placeholder="0" value="80" tabindex="1" class="padding-input" title="Horizontal padding (left, right). Use single value or 'left, right'">
        </div>
        <div class="padding-input-wrapper">
          <svg width="24" height="24" viewBox="0 0 24 24" fill="none" xmlns="http://www.w3.org/2000/svg" class="input-icon-img">
            <path fill-rule="evenodd" clip-rule="evenodd" d="M7.5 16C7.36739 16 7.24021 16.0527 7.14645 16.1464C7.05268 16.2402 7 16.3674 7 16.5C7 16.6326 7.05268 16.7598 7.14645 16.8536C7.24021 16.9473 7.36739 17 7.5 17H16.5C16.6326 17 16.7598 16.9473 16.8536 16.8536C16.9473 16.7598 17 16.6326 17 16.5C17 16.3674 16.9473 16.2402 16.8536 16.1464C16.7598 16.0527 16.6326 16 16.5 16H7.5ZM7 7.5C7 7.36739 7.05268 7.24021 7.14645 7.14645C7.24021 7.05268 7.36739 7 7.5 7H16.5C16.6326 7 16.7598 7.05268 16.8536 7.14645C16.9473 7.24021 17 7.36739 17 7.5C17 7.63261 16.9473 7.75979 16.8536 7.85355C16.7598 7.94732 16.6326 8 16.5 8H7.5C7.36739 8 7.24021 7.94732 7.14645 7.85355C7.05268 7.75979 7 7.63261 7 7.5ZM13 11H11V13H13V11ZM11 10C10.7348 10 10.4804 10.1054 10.2929 10.2929C10.1054 10.4804 10 10.7348 10 11V13C10 13.2652 10.1054 13.5196 10.2929 13.7071C10.4804 13.8946 10.7348 14 11 14H13C13.2652 14 13.5196 13.8946 13.7071 13.7071C13.8946 13.5196 14 13.2652 14 13V11C14 10.7348 13.8946 10.4804 13.7071 10.2929C13.5196 10.1054 13.2652 10 13 10H11Z" fill="currentColor"/>
          </svg>
          <input type="text" id="padding-vertical" placeholder="0" value="80" tabindex="2" class="padding-input" title="Vertical padding (top, bottom). Use single value or 'top, bottom'">
        </div>
      </div>
      <div class="helper-text">Use single value or "left, right" / "top, bottom"</div>
    </div>
    
    <div class="section">
      <div class="label">Items Gap</div>
      <div class="frame-spacing-wrapper">
        <svg width="24" height="24" viewBox="0 0 24 24" fill="none" xmlns="http://www.w3.org/2000/svg" class="input-icon-img">
          <path fill-rule="evenodd" clip-rule="evenodd" d="M12 6C12.1326 6 12.2598 6.05268 12.3536 6.14645C12.4473 6.24021 12.5 6.36739 12.5 6.5V17.5C12.5 17.6326 12.4473 17.7598 12.3536 17.8536C12.2598 17.9473 12.1326 18 12 18C11.8674 18 11.7402 17.9473 11.6464 17.8536C11.5527 17.7598 11.5 17.6326 11.5 17.5V6.5C11.5 6.36739 11.5527 6.24021 11.6464 6.14645C11.7402 6.05268 11.8674 6 12 6ZM9 8C9.26522 8 9.51957 8.10536 9.70711 8.29289C9.89464 8.48043 10 8.73478 10 9V15C10 15.2652 9.89464 15.5196 9.70711 15.7071C9.51957 15.8946 9.26522 16 9 16H7C6.73478 16 6.48043 15.8946 6.29289 15.7071C6.10536 15.5196 6 15.2652 6 15V9C6 8.73478 6.10536 8.48043 6.29289 8.29289C6.48043 8.10536 6.73478 8 7 8H9ZM9 10V9H7V15H9V10ZM18 9C18 8.73478 17.8946 8.48043 17.7071 8.29289C17.5196 8.10536 17.2652 8 17 8H15C14.7348 8 14.4804 8.10536 14.2929 8.29289C14.1054 8.48043 14 8.73478 14 9V15C14 15.2652 14.1054 15.5196 14.2929 15.7071C14.4804 15.8946 14.7348 16 15 16H17C17.2652 16 17.5196 15.8946 17.7071 15.7071C17.8946 15.5196 18 15.2652 18 15V9ZM17 9V15H15V9H17Z" fill="currentColor"/>
        </svg>
        <input type="number" id="frame-spacing" class="frame-spacing-input" placeholder="0" value="0" min="0" step="1" title="Spacing between frames">
      </div>
    </div>
    
    <div class="section" id="alignment-section" style="display: none;">
      <div class="label" id="alignment-label">Alignment</div>
      <div class="alignment-groups" id="alignment-groups">
        <!-- Alignment options will be populated by JavaScript -->
      </div>
    </div>
    
    <div class="error" id="error-message"></div>
    
    <!-- Preset Save Modal -->
    <div class="preset-modal" id="preset-modal">
      <div class="preset-modal-content">
        <h3 class="preset-modal-title">Save Preset</h3>
        <input type="text" id="preset-name-input" class="preset-modal-input" placeholder="Preset name" maxlength="50">
        <div class="preset-modal-buttons">
          <button type="button" class="button-secondary preset-button" id="preset-modal-cancel">Cancel</button>
          <button type="button" class="button-primary preset-button" id="preset-modal-save">Save</button>
        </div>
      </div>
    </div>
    
    <div class="button-group">
      <button class="button-secondary" id="cancel-btn">Cancel</button>
      <button class="button-primary" id="apply-btn">Apply</button>
    </div>
  </div>

  <script>
    const titleEl = document.getElementById('title');
    const paddingHorizontal = document.getElementById('padding-horizontal');
    const paddingVertical = document.getElementById('padding-vertical');
    const frameSpacing = document.getElementById('frame-spacing');
    const layoutHorizontal = document.getElementById('layout-horizontal');
    const layoutVertical = document.getElementById('layout-vertical');
    const layoutMaintain = document.getElementById('layout-maintain');
    const applyBtn = document.getElementById('apply-btn');
    const cancelBtn = document.getElementById('cancel-btn');
    const errorMessage = document.getElementById('error-message');
    const presetDropdownContainer = document.getElementById('preset-dropdown-container');
    const presetDropdownTrigger = document.getElementById('preset-dropdown-trigger');
    const presetDropdownText = document.getElementById('preset-dropdown-text');
    const presetDropdownMenu = document.getElementById('preset-dropdown-menu');
    const presetAddBtn = document.getElementById('preset-add-btn');
    const presetModal = document.getElementById('preset-modal');
    const presetNameInput = document.getElementById('preset-name-input');
    const presetModalSave = document.getElementById('preset-modal-save');
    const presetModalCancel = document.getElementById('preset-modal-cancel');

    let mode = 'create';
    let selectedLayout = 'horizontal'; // Default to horizontal
    let selectedAlignment = 'top'; // Default alignment
    let presets = [];
    let selectedPresetId = 'default';

    const alignmentSection = document.getElementById('alignment-section');
    const alignmentLabel = document.getElementById('alignment-label');
    const alignmentGroups = document.getElementById('alignment-groups');

    // SVG content for alignment icons
    const alignmentIcons = {
      left: '<svg width="24" height="24" viewBox="0 0 24 24" fill="none" xmlns="http://www.w3.org/2000/svg"><path fill-rule="evenodd" clip-rule="evenodd" d="M17.25 10C17.4489 10 17.6397 9.92098 17.7803 9.78033C17.921 9.63968 18 9.44891 18 9.25V8.75C18 8.55109 17.921 8.36032 17.7803 8.21967C17.6397 8.07902 17.4489 8 17.25 8H8.75C8.55109 8 8.36032 8.07902 8.21967 8.21967C8.07902 8.36032 8 8.55109 8 8.75V9.25C8 9.664 8.336 10 8.75 10H17.25ZM13.25 15C13.4489 15 13.6397 14.921 13.7803 14.7803C13.921 14.6397 14 14.4489 14 14.25V13.75C14 13.5511 13.921 13.3603 13.7803 13.2197C13.6397 13.079 13.4489 13 13.25 13H8.75C8.55109 13 8.36032 13.079 8.21967 13.2197C8.07902 13.3603 8 13.5511 8 13.75V14.25C8 14.664 8.336 15 8.75 15H13.25Z" fill="currentColor"/><path d="M6 17.5C6 17.6326 5.94732 17.7598 5.85355 17.8536C5.75979 17.9473 5.63261 18 5.5 18C5.36739 18 5.24021 17.9473 5.14645 17.8536C5.05268 17.7598 5 17.6326 5 17.5V5.5C5 5.36739 5.05268 5.24021 5.14645 5.14645C5.24021 5.05268 5.36739 5 5.5 5C5.63261 5 5.75979 5.05268 5.85355 5.14645C5.94732 5.24021 6 5.36739 6 5.5V17.5Z" fill="currentColor"/></svg>',
      center: '<svg width="24" height="24" viewBox="0 0 24 24" fill="none" xmlns="http://www.w3.org/2000/svg"><path fill-rule="evenodd" clip-rule="evenodd" d="M17.25 10C17.4489 10 17.6397 9.92098 17.7803 9.78033C17.921 9.63968 18 9.44891 18 9.25V8.75C18 8.55109 17.921 8.36032 17.7803 8.21967C17.6397 8.07902 17.4489 8 17.25 8H7.75C7.55109 8 7.36032 8.07902 7.21967 8.21967C7.07902 8.36032 7 8.55109 7 8.75V9.25C7 9.664 7.336 10 7.75 10H17.25ZM15.25 15C15.4489 15 15.6397 14.921 15.7803 14.7803C15.921 14.6397 16 14.4489 16 14.25V13.75C16 13.5511 15.921 13.3603 15.7803 13.2197C15.6397 13.079 15.4489 13 15.25 13H9.75C9.55109 13 9.36032 13.079 9.21967 13.2197C9.07902 13.3603 9 13.5511 9 13.75V14.25C9 14.664 9.336 15 9.75 15H15.25Z" fill="currentColor"/><path fill-rule="evenodd" clip-rule="evenodd" d="M13 17.5C13 17.6326 12.9473 17.7598 12.8536 17.8536C12.7598 17.9473 12.6326 18 12.5 18C12.3674 18 12.2402 17.9473 12.1464 17.8536C12.0527 17.7598 12 17.6326 12 17.5V15H13V17.5ZM13 13V10H12V13H13ZM13 5.5V8H12V5.5C12 5.36739 12.0527 5.24021 12.1464 5.14645C12.2402 5.05268 12.3674 5 12.5 5C12.6326 5 12.7598 5.05268 12.8536 5.14645C12.9473 5.24021 13 5.36739 13 5.5Z" fill="currentColor"/></svg>',
      right: '<svg width="24" height="24" viewBox="0 0 24 24" fill="none" xmlns="http://www.w3.org/2000/svg"><path fill-rule="evenodd" clip-rule="evenodd" d="M6.75 10C6.55109 10 6.36032 9.92098 6.21967 9.78033C6.07902 9.63968 6 9.44891 6 9.25V8.75C6 8.55109 6.07902 8.36032 6.21967 8.21967C6.36032 8.07902 6.55109 8 6.75 8H15.25C15.4489 8 15.6397 8.07902 15.7803 8.21967C15.921 8.36032 16 8.55109 16 8.75V9.25C16 9.44891 15.921 9.63968 15.7803 9.78033C15.6397 9.92098 15.4489 10 15.25 10H6.75ZM10.75 15C10.5511 15 10.3603 14.921 10.2197 14.7803C10.079 14.6397 10 14.4489 10 14.25V13.75C10 13.5511 10.079 13.3603 10.2197 13.2197C10.3603 13.079 10.5511 13 10.75 13H15.25C15.4489 13 15.6397 13.079 15.7803 13.2197C15.921 13.3603 16 13.5511 16 13.75V14.25C16 14.4489 15.921 14.6397 15.7803 14.7803C15.6397 14.921 15.4489 15 15.25 15H10.75Z" fill="currentColor"/><path d="M18 17.5C18 17.6326 18.0527 17.7598 18.1464 17.8536C18.2402 17.9473 18.3674 18 18.5 18C18.6326 18 18.7598 17.9473 18.8536 17.8536C18.9473 17.7598 19 17.6326 19 17.5V5.5C19 5.36739 18.9473 5.24021 18.8536 5.14645C18.7598 5.05268 18.6326 5 18.5 5C18.3674 5 18.2402 5.05268 18.1464 5.14645C18.0527 5.24021 18 5.36739 18 5.5V17.5Z" fill="currentColor"/></svg>',
      top: '<svg width="24" height="24" viewBox="0 0 24 24" fill="none" xmlns="http://www.w3.org/2000/svg"><path fill-rule="evenodd" clip-rule="evenodd" d="M10 17.25C10 17.4489 9.92098 17.6397 9.78033 17.7803C9.63968 17.921 9.44891 18 9.25 18H8.75C8.55109 18 8.36032 17.921 8.21967 17.7803C8.07902 17.6397 8 17.4489 8 17.25V8.75C8 8.55109 8.07902 8.36032 8.21967 8.21967C8.36032 8.07902 8.55109 8 8.75 8H9.25C9.44891 8 9.63968 8.07902 9.78033 8.21967C9.92098 8.36032 10 8.55109 10 8.75V17.25ZM15 13.25C15 13.4489 14.921 13.6397 14.7803 13.7803C14.6397 13.921 14.4489 14 14.25 14H13.75C13.5511 14 13.3603 13.921 13.2197 13.7803C13.079 13.6397 13 13.4489 13 13.25V8.75C13 8.55109 13.079 8.36032 13.2197 8.21967C13.3603 8.07902 13.5511 8 13.75 8H14.25C14.4489 8 14.6397 8.07902 14.7803 8.21967C14.921 8.36032 15 8.55109 15 8.75V13.25Z" fill="currentColor"/><path d="M17.5 6C17.6326 6 17.7598 5.94732 17.8536 5.85355C17.9473 5.75979 18 5.63261 18 5.5C18 5.36739 17.9473 5.24021 17.8536 5.14645C17.7598 5.05268 17.6326 5 17.5 5H5.5C5.36739 5 5.24021 5.05268 5.14645 5.14645C5.05268 5.24021 5 5.36739 5 5.5C5 5.63261 5.05268 5.75979 5.14645 5.85355C5.24021 5.94732 5.36739 6 5.5 6H17.5Z" fill="currentColor"/></svg>',
      middle: '<svg width="24" height="24" viewBox="0 0 24 24" fill="none" xmlns="http://www.w3.org/2000/svg"><path fill-rule="evenodd" clip-rule="evenodd" d="M10 6.75C10 6.55109 9.92098 6.36032 9.78033 6.21967C9.63968 6.07902 9.44891 6 9.25 6H8.75C8.55109 6 8.36032 6.07902 8.21967 6.21967C8.07902 6.36032 8 6.55109 8 6.75V16.25C8 16.664 8.336 17 8.75 17H9.25C9.44891 17 9.63968 16.921 9.78033 16.7803C9.92098 16.6397 10 16.4489 10 16.25V6.75ZM15 8.75C15 8.55109 14.921 8.36032 14.7803 8.21967C14.6397 8.07902 14.4489 8 14.25 8H13.75C13.5511 8 13.3603 8.07902 13.2197 8.21967C13.079 8.36032 13 8.55109 13 8.75V14.25C13 14.664 13.336 15 13.75 15H14.25C14.4489 15 14.6397 14.921 14.7803 14.7803C14.921 14.6397 15 14.4489 15 14.25V8.75Z" fill="currentColor"/><path fill-rule="evenodd" clip-rule="evenodd" d="M17.5 11C17.6326 11 17.7598 11.0527 17.8536 11.1464C17.9473 11.2402 18 11.3674 18 11.5C18 11.6326 17.9473 11.7598 17.8536 11.8536C17.7598 11.9473 17.6326 12 17.5 12H15V11H17.5ZM13 11H10V12H13V11ZM5.5 11H8V12H5.5C5.36739 12 5.24021 11.9473 5.14645 11.8536C5.05268 11.7598 5 11.6326 5 11.5C5 11.3674 5.05268 11.2402 5.14645 11.1464C5.24021 11.0527 5.36739 11 5.5 11Z" fill="currentColor"/></svg>',
      bottom: '<svg width="24" height="24" viewBox="0 0 24 24" fill="none" xmlns="http://www.w3.org/2000/svg"><path fill-rule="evenodd" clip-rule="evenodd" d="M10 6.75C10 6.55109 9.92098 6.36032 9.78033 6.21967C9.63968 6.07902 9.44891 6 9.25 6H8.75C8.55109 6 8.36032 6.07902 8.21967 6.21967C8.07902 6.36032 8 6.55109 8 6.75V15.25C8 15.664 8.336 16 8.75 16H9.25C9.44891 16 9.63968 15.921 9.78033 15.7803C9.92098 15.6397 10 15.4489 10 15.25V6.75ZM15 10.75C15 10.5511 14.921 10.3603 14.7803 10.2197C14.6397 10.079 14.4489 10 14.25 10H13.75C13.5511 10 13.3603 10.079 13.2197 10.2197C13.079 10.3603 13 10.5511 13 10.75V15.25C13 15.664 13.336 16 13.75 16H14.25C14.4489 16 14.6397 15.921 14.7803 15.7803C14.921 15.6397 15 15.4489 15 15.25V10.75Z" fill="currentColor"/><path d="M17.5 18C17.6326 18 17.7598 18.0527 17.8536 18.1464C17.9473 18.2402 18 18.3674 18 18.5C18 18.6326 17.9473 18.7598 17.8536 18.8536C17.7598 18.9473 17.6326 19 17.5 19H5.5C5.36739 19 5.24021 18.9473 5.14645 18.8536C5.05268 18.7598 5 18.6326 5 18.5C5 18.3674 5.05268 18.2402 5.14645 18.1464C5.24021 18.0527 5.36739 18 5.5 18H17.5Z" fill="currentColor"/></svg>'
    };

    // Create alignment options
    function createAlignmentOptions(layout) {
      alignmentGroups.innerHTML = '';
      
      if (layout === 'horizontal') {
        const options = [
          { value: 'top', icon: alignmentIcons.top },
          { value: 'middle', icon: alignmentIcons.middle },
          { value: 'bottom', icon: alignmentIcons.bottom }
        ];
        
        const group = document.createElement('div');
        group.className = 'alignment-group';
        
        options.forEach(option => {
          const button = document.createElement('button');
          button.type = 'button';
          button.className = 'alignment-button';
          button.id = `alignment-${option.value}`;
          button.setAttribute('data-value', option.value);
          button.setAttribute('aria-label', option.value);
          button.setAttribute('title', option.value.charAt(0).toUpperCase() + option.value.slice(1));
          if (selectedAlignment === option.value || (option.value === 'middle' && selectedAlignment === 'center')) {
            button.classList.add('active');
          }
          button.innerHTML = option.icon;
          button.addEventListener('click', () => {
            // Remove active class from all buttons in this group
            group.querySelectorAll('.alignment-button').forEach(btn => btn.classList.remove('active'));
            // Add active class to clicked button
            button.classList.add('active');
            selectedAlignment = option.value === 'middle' ? 'center' : option.value;
          });
          group.appendChild(button);
        });
        
        alignmentGroups.appendChild(group);
      } else if (layout === 'vertical') {
        const options = [
          { value: 'left', icon: alignmentIcons.left },
          { value: 'center', icon: alignmentIcons.center },
          { value: 'right', icon: alignmentIcons.right }
        ];
        
        const group = document.createElement('div');
        group.className = 'alignment-group';
        
        options.forEach(option => {
          const button = document.createElement('button');
          button.type = 'button';
          button.className = 'alignment-button';
          button.id = `alignment-${option.value}`;
          button.setAttribute('data-value', option.value);
          button.setAttribute('aria-label', option.value);
          button.setAttribute('title', option.value.charAt(0).toUpperCase() + option.value.slice(1));
          if (selectedAlignment === option.value) {
            button.classList.add('active');
          }
          button.innerHTML = option.icon;
          button.addEventListener('click', () => {
            // Remove active class from all buttons in this group
            group.querySelectorAll('.alignment-button').forEach(btn => btn.classList.remove('active'));
            // Add active class to clicked button
            button.classList.add('active');
            selectedAlignment = option.value;
          });
          group.appendChild(button);
        });
        
        alignmentGroups.appendChild(group);
      }
    }

    // Handle direction toggle buttons
    const directionToggles = [layoutHorizontal, layoutVertical, layoutMaintain];
    
    directionToggles.forEach(toggle => {
      toggle.addEventListener('click', () => {
        // Remove active class from all toggles
        directionToggles.forEach(t => t.classList.remove('active'));
        // Add active class to clicked toggle
        toggle.classList.add('active');
        selectedLayout = toggle.dataset.layout;
        
        // Show/hide alignment section based on layout
        if (selectedLayout === 'horizontal' || selectedLayout === 'vertical') {
          alignmentSection.style.display = 'block';
          // Reset alignment to default when switching layouts
          if (selectedLayout === 'horizontal') {
            selectedAlignment = 'top';
          } else {
            selectedAlignment = 'left';
          }
          createAlignmentOptions(selectedLayout);
        } else {
          alignmentSection.style.display = 'none';
        }
      });
    });

    // Initialize alignment options
    createAlignmentOptions(selectedLayout);
    alignmentSection.style.display = 'block';

    // Parse comma-separated values (single value or "value1, value2")
    function parseCommaSeparated(value) {
      if (!value || value.trim() === '') {
        return [0, 0];
      }
      
      const parts = value.split(',').map(p => parseFloat(p.trim()) || 0);
      
      if (parts.length === 1) {
        // Single value: apply to both sides
        return [parts[0], parts[0]];
      } else if (parts.length >= 2) {
        // Two values: first and second
        return [parts[0], parts[1]];
      }
      
      return [0, 0];
    }
    
    // Parse padding from horizontal and vertical inputs
    function parsePadding() {
      const horizontal = parseCommaSeparated(paddingHorizontal.value);
      const vertical = parseCommaSeparated(paddingVertical.value);
      
      return {
        top: vertical[0],
        right: horizontal[1],
        bottom: vertical[1],
        left: horizontal[0]
      };
    }

    // Listen for theme changes
    const darkModeMediaQuery = window.matchMedia('(prefers-color-scheme: dark)');
    
    function handleThemeChange(e) {
      // Theme change is handled automatically by CSS media queries
      // This function can be used for any additional theme-related logic if needed
      document.documentElement.setAttribute('data-theme', e.matches ? 'dark' : 'light');
    }
    
    // Set initial theme
    handleThemeChange(darkModeMediaQuery);
    
    // Listen for theme changes
    if (darkModeMediaQuery.addEventListener) {
      darkModeMediaQuery.addEventListener('change', handleThemeChange);
    } else {
      // Fallback for older browsers
      darkModeMediaQuery.addListener(handleThemeChange);
    }


    // Handle apply button
    applyBtn.addEventListener('click', () => {
      hideError();
      
      const padding = parsePadding();
      
      const spacing = parseFloat(frameSpacing.value) || 0;
      
      const layout = selectedLayout;
      const alignment = selectedLayout === 'maintain' ? 'top' : selectedAlignment;
      
      // Validate inputs
      if (padding.top < 0 || padding.right < 0 || padding.bottom < 0 || padding.left < 0) {
        showError('Padding values must be non-negative');
        return;
      }
      
      // Validate padding input format
      const horizontalValue = paddingHorizontal.value.trim();
      const verticalValue = paddingVertical.value.trim();
      
      if (horizontalValue && horizontalValue.split(',').some(p => p.trim() && isNaN(parseFloat(p.trim())))) {
        showError('Invalid horizontal padding format. Use numbers separated by comma.');
        return;
      }
      
      if (verticalValue && verticalValue.split(',').some(p => p.trim() && isNaN(parseFloat(p.trim())))) {
        showError('Invalid vertical padding format. Use numbers separated by comma.');
        return;
      }
      
      if (spacing < 0) {
        showError('Frame spacing must be non-negative');
        return;
      }
      
      parent.postMessage({
        pluginMessage: {
          type: 'apply',
          mode: mode,
          padding: padding,
          spacing: spacing,
          layout: layout,
          alignment: alignment
        }
      }, '*');
    });

    // Handle cancel button
    cancelBtn.addEventListener('click', () => {
      parent.postMessage({
        pluginMessage: {
          type: 'cancel'
        }
      }, '*');
    });


    function showError(message) {
      errorMessage.textContent = message;
      errorMessage.classList.add('show');
    }

    function hideError() {
      errorMessage.classList.remove('show');
    }
    
    // Default preset values
    const defaultPreset = {
      id: 'default',
      name: 'Default',
      padding: { top: 80, right: 80, bottom: 80, left: 80 },
      spacing: 0,
      layout: 'horizontal',
      alignment: 'top'
    };
    
    // Preset management functions
    function updatePresetDropdown() {
      presetDropdownMenu.innerHTML = '';
      
      // Add Default preset (non-deletable)
      const defaultItem = createPresetItem(defaultPreset, false);
      presetDropdownMenu.appendChild(defaultItem);
      
      // Add saved presets
      presets.forEach(preset => {
        const item = createPresetItem(preset, true);
        presetDropdownMenu.appendChild(item);
      });
      
      // Add divider
      const divider = document.createElement('div');
      divider.className = 'preset-dropdown-divider';
      presetDropdownMenu.appendChild(divider);
      
      // Add "Update Preset" action (only if a non-default preset is selected)
      if (selectedPresetId && selectedPresetId !== 'default') {
        const selectedPreset = presets.find(p => p.id === selectedPresetId);
        if (selectedPreset) {
          const updateAction = document.createElement('div');
          updateAction.className = 'preset-dropdown-action';
          updateAction.innerHTML = `
            <svg viewBox="0 0 24 24" fill="none" xmlns="http://www.w3.org/2000/svg">
              <path d="M17 3a2.85 2.85 0 1 1 4 4L7.5 20.5 2 22l1.5-5.5L17 3z" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"/>
            </svg>
            <span>Update "${selectedPreset.name}"</span>
          `;
          updateAction.addEventListener('click', (e) => {
            e.stopPropagation();
            closePresetDropdown();
            updateCurrentPreset();
          });
          presetDropdownMenu.appendChild(updateAction);
        }
      }
      
      // Add "Save Current As Preset..." action
      const saveAction = document.createElement('div');
      saveAction.className = 'preset-dropdown-action';
      saveAction.innerHTML = `
        <svg viewBox="0 0 24 24" fill="none" xmlns="http://www.w3.org/2000/svg">
          <path d="M12 5V19M5 12H19" stroke="currentColor" stroke-width="2" stroke-linecap="round"/>
        </svg>
        <span>Save As New Preset...</span>
      `;
      saveAction.addEventListener('click', (e) => {
        e.stopPropagation();
        closePresetDropdown();
        openSavePresetModal();
      });
      presetDropdownMenu.appendChild(saveAction);
      
      // Update trigger text
      updatePresetTriggerText();
    }
    
    function createPresetItem(preset, deletable) {
      const item = document.createElement('div');
      item.className = 'preset-dropdown-item';
      if (preset.id === selectedPresetId) {
        item.classList.add('selected');
      }
      item.dataset.presetId = preset.id;
      
      const text = document.createElement('span');
      text.className = 'preset-dropdown-item-text';
      text.textContent = preset.name;
      item.appendChild(text);
      
      if (deletable) {
        const deleteBtn = document.createElement('button');
        deleteBtn.type = 'button';
        deleteBtn.className = 'preset-dropdown-item-delete';
        deleteBtn.setAttribute('aria-label', `Remove preset ${preset.name}`);
        deleteBtn.innerHTML = `
          <svg viewBox="0 0 24 24" fill="none" xmlns="http://www.w3.org/2000/svg">
            <path d="M3 6H5H21" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"/>
            <path d="M8 6V4C8 3.46957 8.21071 2.96086 8.58579 2.58579C8.96086 2.21071 9.46957 2 10 2H14C14.5304 2 15.0391 2.21071 15.4142 2.58579C15.7893 2.96086 16 3.46957 16 4V6M19 6V20C19 20.5304 18.7893 21.0391 18.4142 21.4142C18.0391 21.7893 17.5304 22 17 22H7C6.46957 22 5.96086 21.7893 5.58579 21.4142C5.21071 21.0391 5 20.5304 5 20V6H19Z" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"/>
          </svg>
        `;
        deleteBtn.addEventListener('click', (e) => {
          e.stopPropagation();
          deletePresetById(preset.id);
        });
        item.appendChild(deleteBtn);
      }
      
      item.addEventListener('click', () => {
        selectPreset(preset.id);
        closePresetDropdown();
      });
      
      return item;
    }
    
    function updatePresetTriggerText() {
      if (selectedPresetId === 'default' || !selectedPresetId) {
        presetDropdownText.textContent = 'Default';
      } else {
        const preset = presets.find(p => p.id === selectedPresetId);
        presetDropdownText.textContent = preset ? preset.name : 'Default';
      }
    }
    
    function openPresetDropdown() {
      presetDropdownContainer.classList.add('open');
    }
    
    function closePresetDropdown() {
      presetDropdownContainer.classList.remove('open');
    }
    
    function togglePresetDropdown() {
      if (presetDropdownContainer.classList.contains('open')) {
        closePresetDropdown();
      } else {
        openPresetDropdown();
      }
    }
    
    function selectPreset(presetId) {
      selectedPresetId = presetId;
      
      let preset;
      if (presetId === 'default') {
        preset = defaultPreset;
      } else {
        preset = presets.find(p => p.id === presetId);
      }
      
      if (preset) {
        loadPreset(preset);
      }
      
      updatePresetDropdown();
    }
    
    function deletePresetById(presetId) {
      parent.postMessage({
        pluginMessage: {
          type: 'delete-preset',
          presetId: presetId
        }
      }, '*');
    }
    
    function openSavePresetModal() {
      presetNameInput.value = '';
      presetModal.classList.add('show');
      presetNameInput.focus();
    }
    
    function updateCurrentPreset() {
      if (!selectedPresetId || selectedPresetId === 'default') return;
      
      const settings = getCurrentSettings();
      
      parent.postMessage({
        pluginMessage: {
          type: 'update-preset',
          presetId: selectedPresetId,
          padding: settings.padding,
          spacing: settings.spacing,
          layout: settings.layout,
          alignment: settings.alignment
        }
      }, '*');
    }
    
    function loadPreset(preset) {
      if (!preset) return;
      
      // Set padding
      const padding = preset.padding;
      if (padding.top === padding.bottom && padding.left === padding.right) {
        if (padding.top === padding.left) {
          paddingHorizontal.value = Math.round(padding.left).toString();
          paddingVertical.value = Math.round(padding.top).toString();
        } else {
          paddingHorizontal.value = Math.round(padding.left).toString();
          paddingVertical.value = Math.round(padding.top).toString();
        }
      } else {
        paddingHorizontal.value = `${Math.round(padding.left)}, ${Math.round(padding.right)}`;
        paddingVertical.value = `${Math.round(padding.top)}, ${Math.round(padding.bottom)}`;
      }
      
      // Set spacing
      frameSpacing.value = Math.round(preset.spacing).toString();
      
      // Set layout
      selectedLayout = preset.layout;
      directionToggles.forEach(toggle => {
        toggle.classList.remove('active');
        if (toggle.dataset.layout === selectedLayout) {
          toggle.classList.add('active');
        }
      });
      
      // Set alignment
      if (selectedLayout === 'horizontal' || selectedLayout === 'vertical') {
        alignmentSection.style.display = 'block';
        selectedAlignment = preset.alignment;
        createAlignmentOptions(selectedLayout);
        const alignmentButton = document.getElementById(`alignment-${selectedAlignment === 'center' ? 'middle' : selectedAlignment}`);
        if (alignmentButton) {
          alignmentGroups.querySelectorAll('.alignment-button').forEach(btn => btn.classList.remove('active'));
          alignmentButton.classList.add('active');
        }
      } else {
        alignmentSection.style.display = 'none';
      }
    }
    
    function getCurrentSettings() {
      const padding = parsePadding();
      const spacing = parseFloat(frameSpacing.value) || 0;
      const layout = selectedLayout;
      const alignment = selectedLayout === 'maintain' ? 'top' : selectedAlignment;
      
      return { padding, spacing, layout, alignment };
    }
    
    // Preset dropdown trigger handler
    presetDropdownTrigger.addEventListener('click', (e) => {
      e.stopPropagation();
      togglePresetDropdown();
    });
    
    // Preset add button handler
    presetAddBtn.addEventListener('click', (e) => {
      e.stopPropagation();
      openSavePresetModal();
    });
    
    // Close dropdown when clicking outside
    document.addEventListener('click', (e) => {
      if (!presetDropdownContainer.contains(e.target)) {
        closePresetDropdown();
      }
    });
    
    // Preset modal handlers
    presetModalCancel.addEventListener('click', () => {
      presetModal.classList.remove('show');
    });
    
    presetModalSave.addEventListener('click', () => {
      const name = presetNameInput.value.trim();
      if (!name) {
        showError('Please enter a preset name');
        return;
      }
      
      // Check for duplicate names (case-insensitive)
      const duplicateName = presets.some(p => p.name.toLowerCase() === name.toLowerCase());
      if (duplicateName) {
        showError('A preset with this name already exists');
        return;
      }
      
      const settings = getCurrentSettings();
      
      parent.postMessage({
        pluginMessage: {
          type: 'save-preset',
          name: name,
          padding: settings.padding,
          spacing: settings.spacing,
          layout: settings.layout,
          alignment: settings.alignment
        }
      }, '*');
      
      presetModal.classList.remove('show');
    });
    
    // Close modal on escape key
    document.addEventListener('keydown', (e) => {
      if (e.key === 'Escape') {
        if (presetModal.classList.contains('show')) {
          presetModal.classList.remove('show');
        }
        closePresetDropdown();
      }
    });
    
    // Handle preset name input enter key
    presetNameInput.addEventListener('keydown', (e) => {
      if (e.key === 'Enter') {
        presetModalSave.click();
      }
    });
    
    // Request presets list on load
    parent.postMessage({
      pluginMessage: {
        type: 'list-presets'
      }
    }, '*');
    
    // Initialize with default preset selected
    selectedPresetId = 'default';
    
    // Handle messages from plugin
    window.onmessage = (event) => {
      const msg = event.data.pluginMessage;
      
      if (msg.type === 'presets-list') {
        presets = msg.presets || [];
        updatePresetDropdown();
        return;
      }
      
      if (msg.type === 'preset-saved') {
        presets.push(msg.preset);
        selectedPresetId = msg.preset.id;
        updatePresetDropdown();
        return;
      }
      
      if (msg.type === 'preset-loaded') {
        loadPreset(msg.preset);
        return;
      }
      
      if (msg.type === 'preset-deleted') {
        presets = presets.filter(p => p.id !== msg.presetId);
        if (selectedPresetId === msg.presetId) {
          selectedPresetId = 'default';
          loadPreset(defaultPreset);
        }
        updatePresetDropdown();
        return;
      }
      
      if (msg.type === 'preset-updated') {
        const index = presets.findIndex(p => p.id === msg.preset.id);
        if (index >= 0) {
          presets[index] = msg.preset;
        }
        updatePresetDropdown();
        return;
      }
      
      if (msg.type === 'preset-error') {
        showError(msg.error || 'Preset operation failed');
        return;
      }
      
      if (msg.type === 'init') {
        mode = msg.mode;
        titleEl.textContent = mode === 'create' ? 'Create Section' : 'Update Section';
        
        // Auto-detect and set spacing if detected
        // Allow 0 as a valid spacing value
        console.log('UI - Received detectedSpacing:', msg.detectedSpacing, 'type:', typeof msg.detectedSpacing);
        if (msg.detectedSpacing !== null && msg.detectedSpacing !== undefined) {
          const spacingValue = Math.round(msg.detectedSpacing).toString();
          console.log('UI - Setting frame spacing to:', spacingValue);
          frameSpacing.value = spacingValue;
        } else {
          // If no spacing detected, default to 0
          console.log('UI - No spacing detected, defaulting to 0');
          frameSpacing.value = '0';
        }
        
        // Set current padding values if in update mode
        if (msg.mode === 'update' && msg.currentPadding) {
          const padding = msg.currentPadding;
          // Check if all padding values are the same
          if (padding.top === padding.right && padding.right === padding.bottom && padding.bottom === padding.left) {
            // All same, use single value
            paddingHorizontal.value = Math.round(padding.left).toString();
            paddingVertical.value = Math.round(padding.top).toString();
          } else if (padding.top === padding.bottom && padding.left === padding.right) {
            // Top/bottom same, left/right same
            paddingHorizontal.value = Math.round(padding.left).toString();
            paddingVertical.value = Math.round(padding.top).toString();
          } else {
            // Different values, use comma-separated format
            paddingHorizontal.value = `${Math.round(padding.left)}, ${Math.round(padding.right)}`;
            paddingVertical.value = `${Math.round(padding.top)}, ${Math.round(padding.bottom)}`;
          }
        }
        
        // Set detected layout and alignment if provided
        if (msg.detectedLayout) {
          selectedLayout = msg.detectedLayout;
          // Update layout toggle buttons
          directionToggles.forEach(toggle => {
            toggle.classList.remove('active');
            if (toggle.dataset.layout === selectedLayout) {
              toggle.classList.add('active');
            }
          });
          
          // Show/hide alignment section and create options
          if (selectedLayout === 'horizontal' || selectedLayout === 'vertical') {
            alignmentSection.style.display = 'block';
            createAlignmentOptions(selectedLayout);
            
            // Set alignment after options are created
            if (msg.detectedAlignment) {
              selectedAlignment = msg.detectedAlignment;
              // Set the alignment button
              const alignmentButton = document.getElementById(`alignment-${selectedAlignment === 'center' ? 'middle' : selectedAlignment}`);
              if (alignmentButton) {
                // Remove active from all buttons in the group
                alignmentGroups.querySelectorAll('.alignment-button').forEach(btn => btn.classList.remove('active'));
                // Add active to the correct button
                alignmentButton.classList.add('active');
              }
            }
          } else {
            alignmentSection.style.display = 'none';
          }
        } else if (msg.detectedAlignment) {
          // If layout wasn't set but alignment was, just set the alignment
          selectedAlignment = msg.detectedAlignment;
          const alignmentButton = document.getElementById(`alignment-${selectedAlignment === 'center' ? 'middle' : selectedAlignment}`);
          if (alignmentButton) {
            // Remove active from all buttons in the group
            alignmentGroups.querySelectorAll('.alignment-button').forEach(btn => btn.classList.remove('active'));
            // Add active to the correct button
            alignmentButton.classList.add('active');
          }
        }
        
        // Request presets list after init
        parent.postMessage({
          pluginMessage: {
            type: 'list-presets'
          }
        }, '*');
      }
    };
  </script>
</body>
</html>

